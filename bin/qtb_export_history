#!/bin/bash
# opens qutebrowser today history in vim. Optionally accepts argument - number
# of days offset

# take argument value or default to "0" if it is unset
day_shift="${1:-0}"

sqlite3 -column ~/.local/share/qutebrowser/history.sqlite \
    "SELECT
        strftime('%Y/%m/%d %H:%M', datetime(atime, 'unixepoch', 'localtime')) as date_time,
        title,
        url,
        redirect
    FROM History
    WHERE atime > unixepoch('now', '-$day_shift day', 'start of day')
    ORDER BY atime" | split_much_delta | nvim +'setlocal nowrap'
